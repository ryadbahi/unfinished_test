<body>
  <div
    id="dropzone"
    (drop)="dropped($event)"
    (dragover)="$event.preventDefault()"
  >
    >>>>>>>> lachez ici ! <<<<<<<<<
  </div>
  <mat-toolbar class="matoolB">
    <input
      type="file"
      (change)="handleFileUpload($event)"
      webkitdirectory
      multiple
    />

    <button class="xlsdl" (click)="downloadExcel()">
      <img class="icon" src="assets/xlsicn.png" />
    </button>
  </mat-toolbar>

  <div class="mat-elevation-z8" style="border-radius: 10px; overflow: hidden">
    <table mat-table [dataSource]="dataSource" multiTemplateDataRows>
      <div class="MainRow">
        <ng-container matColumnDef="id">
          <th
            mat-header-cell
            *matHeaderCellDef
            style="font-size: 16px; font-weight: bolder"
          >
            N°
          </th>
          <td mat-cell *matCellDef="let element">
            <div>{{ element.id }}</div>
          </td>
        </ng-container>
        <ng-container matColumnDef="souscripteur">
          <th
            mat-header-cell
            *matHeaderCellDef
            style="font-size: 16px; font-weight: bolder"
          >
            Souscripteur
          </th>
          <td mat-cell *matCellDef="let element" style="font-weight: bolder">
            <div>{{ element.souscripteur }}</div>
          </td>
        </ng-container>

        <ng-container matColumnDef="trtPar">
          <th
            mat-header-cell
            *matHeaderCellDef
            style="font-size: 16px; font-weight: bolder"
          >
            Traité par
          </th>
          <td mat-cell *matCellDef="let element" style="font-weight: bolder">
            <div>{{ element.trtPar }}</div>
          </td>
        </ng-container>

        <ng-container matColumnDef="dossier">
          <th
            mat-header-cell
            *matHeaderCellDef
            style="font-size: 16px; font-weight: bolder"
          >
            Sinistre n°
          </th>
          <td mat-cell *matCellDef="let element" style="font-weight: bolder">
            <div>{{ element.dossier }}</div>
          </td>
        </ng-container>

        <ng-container matColumnDef="total">
          <th
            mat-header-cell
            *matHeaderCellDef
            style="font-size: 16px; font-weight: bolder"
          >
            Totaux
          </th>
          <td mat-cell *matCellDef="let element" style="font-weight: bolder">
            <div>{{ element.total | number : "1.2-2" }}</div>
          </td>
        </ng-container>
      </div>
      <ng-container matColumnDef="expandedDetail">
        <td
          mat-cell
          *matCellDef="let element"
          [attr.colspan]="displayedColumns.length"
        >
          <div class="detailDisplay" [@detailExpand]="isExpanded(element)">
            <table
              mat-table
              [dataSource]="element.paraphDetails"
              class="mat-elevation-z8"
              id="childtable"
            >
              <ng-container matColumnDef="serial">
                <th mat-header-cell *matHeaderCellDef>N°</th>
                <td mat-cell *matCellDef="let element">
                  <div>{{ element.serial }}</div>
                </td>
              </ng-container>
              <ng-container matColumnDef="beneficiaire">
                <th mat-header-cell *matHeaderCellDef>Bénéf</th>
                <td mat-cell *matCellDef="let element">
                  <div>{{ element.beneficiaire }}</div>
                </td>
              </ng-container>
              <ng-container matColumnDef="rib">
                <th mat-header-cell *matHeaderCellDef>RIB</th>
                <td
                  mat-cell
                  *matCellDef="let element"
                  [ngStyle]="{ color: element.highlightRib }"
                >
                  <div>{{ element.rib }}</div>
                </td>
              </ng-container>
              <ng-container matColumnDef="montant">
                <th mat-header-cell *matHeaderCellDef>Montant</th>
                <td mat-cell *matCellDef="let element">
                  <div style="float: right">
                    {{ element.montant | number : "1.2-2" }}
                  </div>
                </td>
              </ng-container>

              <tr
                mat-header-row
                *matHeaderRowDef="displayedDetailsColumns"
              ></tr>
              <tr
                mat-row
                *matRowDef="let row; columns: displayedDetailsColumns"
              ></tr>
            </table>
          </div>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: displayedColumns"
        [ngClass]="{
    'grey-row': row.paraphDetails.length === 0,
    'expanded-row': expandedElements.indexOf(row) !== -1,
  }"
        (click)="row.paraphDetails.length > 0 ? toggleDetails(row) : null"
      ></tr>

      <tr
        mat-row
        *matRowDef="let row; columns: ['expandedDetail']"
        id="detail-row"
      ></tr>
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="4">No data matching the filter</td>
      </tr>
    </table>
  </div>
</body>
